

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pycrossva.validation &mdash; CrossVA 1.0a documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> CrossVA
          

          
          </a>

          
            
            
              <div class="version">
                1.0a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#simple-usage">Simple Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#command-line">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#currently-supported">Currently Supported</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#roadmap">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#style">Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#license">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Custom Mappings</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">Configuration Files</a></li>
</ul>
<p class="caption"><span class="caption-text">Under the hood</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../source/transform.html">transform function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/configuration.html">configuration module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/validation.html">validation module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/mappings.html">mappings module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CrossVA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pycrossva.validation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pycrossva.validation</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module containing Validation class, and Vcheck class and its subclasses</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">abc</span> <span class="k">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="k">import</span> <span class="n">report_list</span>


<div class="viewcode-block" id="VCheck"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.VCheck">[docs]</a><span class="k">class</span> <span class="nc">VCheck</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract class fior a single validation check&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inits VCheck class</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): the message associated with the validation check,</span>
<span class="sd">            which should describe why the check has passed or failed.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; VCheck(&quot;Test Message&quot;)</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">            TypeError: Can&#39;t instantiate abstract class VCheck with abstract</span>
<span class="sd">            methods bullet, level, tier, title</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>

<div class="viewcode-block" id="VCheck.expand"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.VCheck.expand">[docs]</a>    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Expands VCheck information as a Pandas Series</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas Series: representing VCheck attributes as a Pandas Series</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; Err(&quot;Error Message&quot;).expand()</span>
<span class="sd">            Tier               Error</span>
<span class="sd">            Bullet               [!]</span>
<span class="sd">            Level                  1</span>
<span class="sd">            Title             ERRORS</span>
<span class="sd">            Message    Error Message</span>
<span class="sd">            dtype: object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">tier</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">bullet</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">],</span>
                         <span class="p">[</span><span class="s2">&quot;Tier&quot;</span><span class="p">,</span> <span class="s2">&quot;Bullet&quot;</span><span class="p">,</span> <span class="s2">&quot;Level&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">])</span></div>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">tier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;abstract property, must be overriden.</span>
<span class="sd">        Should be str, representing name of VCheck tier&quot;&quot;&quot;</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">bullet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;abstract property, must be overriden.</span>
<span class="sd">        Should be a str, representing a bullet point&quot;&quot;&quot;</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;abstract property, must be overriden.</span>
<span class="sd">        Should be int ,representing VCheck tier&quot;&quot;&quot;</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;abstract property, must be overriden.</span>
<span class="sd">        Should be str, representing title of VCheck type&quot;&quot;&quot;</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Err"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Err">[docs]</a><span class="k">class</span> <span class="nc">Err</span><span class="p">(</span><span class="n">VCheck</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;VCheck subclass representing a serious problem in data validation</span>
<span class="sd">    that prevents validation.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; Err(&quot;This is a data validation error&quot;).expand()</span>
<span class="sd">        Tier                                 Error</span>
<span class="sd">        Bullet                                 [!]</span>
<span class="sd">        Level                                    1</span>
<span class="sd">        Title                               ERRORS</span>
<span class="sd">        Message    This is a data validation error</span>
<span class="sd">        dtype: object</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Err.tier"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Err.tier">[docs]</a>    <span class="k">def</span> <span class="nf">tier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Error&quot;</span></div>

<div class="viewcode-block" id="Err.bullet"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Err.bullet">[docs]</a>    <span class="k">def</span> <span class="nf">bullet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[!]&quot;</span></div>

<div class="viewcode-block" id="Err.level"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Err.level">[docs]</a>    <span class="k">def</span> <span class="nf">level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Err.title"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Err.title">[docs]</a>    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ERRORS&quot;</span></div></div>


<div class="viewcode-block" id="Warn"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Warn">[docs]</a><span class="k">class</span> <span class="nc">Warn</span><span class="p">(</span><span class="n">VCheck</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;VCheck subclass representing a problem in data validation that</span>
<span class="sd">    can be fixed in place, but would otherwise prevent validation.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; Warn(&quot;This is a data validation warning&quot;).expand()</span>
<span class="sd">        Tier                                 Warning</span>
<span class="sd">        Bullet                                   [?]</span>
<span class="sd">        Level                                      2</span>
<span class="sd">        Title                               WARNINGS</span>
<span class="sd">        Message    This is a data validation warning</span>
<span class="sd">        dtype: object</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Warn.tier"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Warn.tier">[docs]</a>    <span class="k">def</span> <span class="nf">tier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Warning&quot;</span></div>

<div class="viewcode-block" id="Warn.bullet"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Warn.bullet">[docs]</a>    <span class="k">def</span> <span class="nf">bullet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[?]&quot;</span></div>

<div class="viewcode-block" id="Warn.level"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Warn.level">[docs]</a>    <span class="k">def</span> <span class="nf">level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="Warn.title"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Warn.title">[docs]</a>    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;WARNINGS&quot;</span></div></div>


<div class="viewcode-block" id="Suggest"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Suggest">[docs]</a><span class="k">class</span> <span class="nc">Suggest</span><span class="p">(</span><span class="n">VCheck</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;VCheck subclass representing a minor problem with data that</span>
<span class="sd">    does not prevent data validation.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; Suggest(&quot;This is a data validation suggestion&quot;).expand()</span>
<span class="sd">        Tier                                 Suggestion</span>
<span class="sd">        Bullet                                      [i]</span>
<span class="sd">        Level                                         3</span>
<span class="sd">        Title                               SUGGESTIONS</span>
<span class="sd">        Message    This is a data validation suggestion</span>
<span class="sd">        dtype: object</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Suggest.tier"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Suggest.tier">[docs]</a>    <span class="k">def</span> <span class="nf">tier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Suggestion&quot;</span></div>

<div class="viewcode-block" id="Suggest.bullet"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Suggest.bullet">[docs]</a>    <span class="k">def</span> <span class="nf">bullet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[i]&quot;</span></div>

<div class="viewcode-block" id="Suggest.level"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Suggest.level">[docs]</a>    <span class="k">def</span> <span class="nf">level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="Suggest.title"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Suggest.title">[docs]</a>    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;SUGGESTIONS&quot;</span></div></div>


<div class="viewcode-block" id="Passing"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Passing">[docs]</a><span class="k">class</span> <span class="nc">Passing</span><span class="p">(</span><span class="n">VCheck</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;VCheck subclass representing a passed check in data validation, where</span>
<span class="sd">    there is no problem.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; Passing(&quot;This is a passing data validation check&quot;).expand()</span>
<span class="sd">        Tier                                       Passing</span>
<span class="sd">        Bullet                                         [X]</span>
<span class="sd">        Level                                            4</span>
<span class="sd">        Title                                CHECKS PASSED</span>
<span class="sd">        Message    This is a passing data validation check</span>
<span class="sd">        dtype: object</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Passing.tier"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Passing.tier">[docs]</a>    <span class="k">def</span> <span class="nf">tier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Passing&quot;</span></div>

<div class="viewcode-block" id="Passing.bullet"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Passing.bullet">[docs]</a>    <span class="k">def</span> <span class="nf">bullet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[X]&quot;</span></div>

<div class="viewcode-block" id="Passing.level"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Passing.level">[docs]</a>    <span class="k">def</span> <span class="nf">level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">4</span></div>

<div class="viewcode-block" id="Passing.title"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Passing.title">[docs]</a>    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;CHECKS PASSED&quot;</span></div></div>


<div class="viewcode-block" id="Validation"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation">[docs]</a><span class="k">class</span> <span class="nc">Validation</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Validation object represents an organized dataframe of validation checks</span>

<span class="sd">    Attributes:</span>
<span class="sd">        vchecks (Pandas DataFrame): a dataframe containing the expanded form</span>
<span class="sd">            of the VCheck instances that have been added.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;inits Validation class&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_add_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagged_series</span><span class="p">,</span> <span class="n">pass_check</span><span class="p">,</span> <span class="n">fail_check</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Internal method that adds a fail_check to the self.vchecks attribute</span>
<span class="sd">        if any in flagged_series are True, else adds pass_check to the</span>
<span class="sd">        self.vchecks attribute. Both fail_check and pass_check are appended to</span>
<span class="sd">        self.vchecks through their .expand() method, which returns their</span>
<span class="sd">        information as a Pandas Series.</span>

<span class="sd">        Args:</span>
<span class="sd">            flagged_series (Pandas Series): a boolean Pandas Series, where True</span>
<span class="sd">                represents a failed condition that has been flagged.</span>
<span class="sd">            pass_check (VCheck): the VCheck to report if the check passes</span>
<span class="sd">            fail_check (VCheck): the VCheck to report if the check fails</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, False]),\</span>
<span class="sd">                                 Passing(&quot;Passed test&quot;), Err(&quot;Failed test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, True]),\</span>
<span class="sd">                                 Passing(&quot;Passed test&quot;), Err(&quot;Failed test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v.vchecks</span>
<span class="sd">              Bullet  Level      Message     Tier          Title</span>
<span class="sd">            0    [X]    4.0  Passed test  Passing  CHECKS PASSED</span>
<span class="sd">            1    [!]    1.0  Failed test    Error         ERRORS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">flagged_series</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fail_check</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span>
                                               <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pass_check</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span>
                                               <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="Validation.no_duplicates"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.no_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">no_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_series</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; adds a validation check as `Err` if any items in my_series are</span>
<span class="sd">        duplicates. Intended to alert users of issues where there are duplicate</span>
<span class="sd">        columns before an exception is raised.</span>

<span class="sd">            my_series (Pandas Series): series where there should not be dupes</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comparison</span> <span class="o">=</span> <span class="n">my_series</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
        <span class="n">passing_msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Source column IDs do not match more than one column in&quot;</span>
                       <span class="s2">&quot; input data.&quot;</span><span class="p">)</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="s2">&quot;{comparison.sum()} source column IDs {report_list(my_series[comparison])}&quot;</span>
                    <span class="s2">&quot; were found multiple times in the input data. Each source&quot;</span>
                    <span class="s2">&quot; column ID should only occur once as part of an input data&quot;</span>
                    <span class="s2">&quot; column name. It should be a unique identifier at&quot;</span>
                    <span class="s2">&quot; the end of an input data column name. Source column IDs&quot;</span>
                    <span class="s2">&quot; are case sensitive. Please revise your mapping configuration&quot;</span>
                    <span class="s2">&quot; or your input data so that this condition is satisfied.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_condition</span><span class="p">(</span><span class="n">my_series</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(),</span> <span class="n">Passing</span><span class="p">(</span><span class="n">passing_msg</span><span class="p">),</span>
                            <span class="n">Err</span><span class="p">(</span><span class="n">fail_msg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Validation.affected_by_absence"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.affected_by_absence">[docs]</a>    <span class="k">def</span> <span class="nf">affected_by_absence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">missing_grped</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; adds a validation check as `Warn` describing the items in missing_grped,</span>
<span class="sd">        which detail the impact that missing columns have on newly created</span>
<span class="sd">        mappings.</span>
<span class="sd">            missing_grped (Pandas Series): series where the index is the name</span>
<span class="sd">                of the missing source column, and the values are a list of</span>
<span class="sd">                affected values.</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">affected_list</span> <span class="ow">in</span> <span class="n">missing_grped</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="s2">&quot;&#39;</span><span class="si">{source}</span><span class="s2">&#39; is missing, which affects the creation of &quot;</span>
                   <span class="n">f</span><span class="s2">&quot; column(s) {report_list(affected_list, paren=False)}&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(),</span>
                                               <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Validation.must_contain"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.must_contain">[docs]</a>    <span class="k">def</span> <span class="nf">must_contain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">passing_msg</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fail</span><span class="o">=</span><span class="n">Err</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;adds a validation check where `given` must contain every item in</span>
<span class="sd">        `required` at least once to pass, and `fail_check` is `fail`,</span>
<span class="sd">        (fails validation).</span>

<span class="sd">        Args:</span>
<span class="sd">            given (Pandas Series): the items representing input given</span>
<span class="sd">            required (Pandas Series): the items required to be in `given`</span>
<span class="sd">            passing_msg (str): Message to return if all items in `expected` are</span>
<span class="sd">                listed in `given`. Defaults to &quot;&quot;.</span>
<span class="sd">            fail (VCheck): the outcome if the check fails. Default is Err.</span>
<span class="sd">            impact (Pandas Series): a corresponding series to `required` that</span>
<span class="sd">                represents the affected information when</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; v.must_contain(pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], name=&quot;example input&quot;),\</span>
<span class="sd">                               pd.Series([&quot;a&quot;,&quot;b&quot;],\</span>
<span class="sd">                                         name=&quot;example requirement(s)&quot;),\</span>
<span class="sd">                               &quot;all included&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.must_contain(pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], name=&quot;example input&quot;),\</span>
<span class="sd">                               pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;d&quot;],\</span>
<span class="sd">                                         name=&quot;example requirement(s)&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]          all included</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             ERRORS</span>
<span class="sd">             [!]          1 (&#39;d&#39;) example requirement(s) were not found in \</span>
<span class="sd">             example input. Their values will be NA.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="c1"># Comparison is true (fails) when an item in required isn&#39;t in given</span>
        <span class="n">comparison</span> <span class="o">=</span> <span class="o">~</span><span class="n">required</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">comparison</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span>
                             <span class="n">report_list</span><span class="p">(</span><span class="n">required</span><span class="p">[</span><span class="n">comparison</span><span class="p">]),</span>
                             <span class="nb">str</span><span class="p">(</span><span class="n">required</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                             <span class="s2">&quot;were not found in&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">given</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Their values will be NA.&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_condition</span><span class="p">(</span><span class="n">comparison</span><span class="p">,</span> <span class="n">Passing</span><span class="p">(</span><span class="n">passing_msg</span><span class="p">),</span>
                            <span class="n">fail</span><span class="p">(</span><span class="n">fail_msg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Validation.no_extraneous"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.no_extraneous">[docs]</a>    <span class="k">def</span> <span class="nf">no_extraneous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span> <span class="n">relevant</span><span class="p">,</span> <span class="n">value_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;adds a validation check where all values in `given` should also be</span>
<span class="sd">        in `relevant` to pass. `fail_check` is `Warn`</span>

<span class="sd">        Args:</span>
<span class="sd">            given (Pandas Series): the items representing input given</span>
<span class="sd">            relevant (Pandas Series): all items in `given` that will be used</span>
<span class="sd">            value_type (str): string describing the kind of noun that is</span>
<span class="sd">                listed in `given`</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; v.no_extraneous(pd.Series([&quot;a&quot;,&quot;b&quot;], name=&quot;example input&quot;),\</span>
<span class="sd">                               pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;],\</span>
<span class="sd">                                         name=&quot;relevant value(s)&quot;), &quot;example&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.no_extraneous(pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], name=&quot;example input&quot;),\</span>
<span class="sd">                               pd.Series([&quot;a&quot;,&quot;d&quot;],\</span>
<span class="sd">                                         name=&quot;relevant value(s)&quot;), &quot;example&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            CHECKS PASSED</span>
<span class="sd">            [X]      No extraneous example found in example input.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            ERRORS</span>
<span class="sd">            [!]      2 extraneous example(s) found in example input</span>
<span class="sd">            (&#39;b&#39;, and &#39;c&#39;) Extraneous example(s) will be ommitted.</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="c1"># comparison is true (fails) when an  item in `given` isn&#39;t in</span>
        <span class="c1"># `relevant`</span>
        <span class="n">comparison</span> <span class="o">=</span> <span class="o">~</span><span class="n">given</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">relevant</span><span class="p">)</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">comparison</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span>
                             <span class="s2">&quot;extraneous&quot;</span><span class="p">,</span> <span class="n">value_type</span> <span class="o">+</span> <span class="s2">&quot;(s)&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;found in&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">given</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                             <span class="n">report_list</span><span class="p">(</span><span class="n">given</span><span class="p">[</span><span class="n">comparison</span><span class="p">],</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
                             <span class="s2">&quot;Extraneous&quot;</span><span class="p">,</span> <span class="n">value_type</span> <span class="o">+</span> <span class="s2">&quot;(s)&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;will be ommitted.&quot;</span><span class="p">])</span>
        <span class="n">passing_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;No extraneous&quot;</span><span class="p">,</span> <span class="n">value_type</span><span class="p">,</span> <span class="s2">&quot;found in&quot;</span><span class="p">,</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">given</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_condition</span><span class="p">(</span><span class="n">comparison</span><span class="p">,</span> <span class="n">Passing</span><span class="p">(</span><span class="n">passing_msg</span><span class="p">),</span>
                            <span class="n">Err</span><span class="p">(</span><span class="n">fail_msg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Validation.all_valid"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.all_valid">[docs]</a>    <span class="k">def</span> <span class="nf">all_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">given</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">definition</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;adds a validation check where all values in `given` must be in `valid`</span>
<span class="sd">        to pass. `fail_check` is `Err` (fails validation).</span>

<span class="sd">        Args:</span>
<span class="sd">            given (Pandas Series): the items representing input given</span>
<span class="sd">            valid (Pandas Series): list of all possible valid items accepted in</span>
<span class="sd">                `given`</span>
<span class="sd">            definition (str): string describing what makes an item in `given`</span>
<span class="sd">                be in `valid`</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; v.all_valid(pd.Series([&quot;a&quot;,&quot;b&quot;], name=&quot;example input&quot;),\</span>
<span class="sd">                               pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;],\</span>
<span class="sd">                                         name=&quot;valid value(s)&quot;), &quot;pre-defined&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.all_valid(pd.Series([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], name=&quot;example input&quot;),\</span>
<span class="sd">                               pd.Series([&quot;a&quot;,&quot;d&quot;],\</span>
<span class="sd">                                         name=&quot;valid value(s)&quot;), &quot;&#39;a&#39; or &#39;d&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]          All values in example input are valid.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             ERRORS</span>
<span class="sd">            [!]          2 values in example input were invalid (&#39;b&#39;, and &#39;c&#39;).</span>
<span class="sd">            These must be &#39;a&#39; or &#39;d&#39; to be valid.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
        <span class="c1"># comparison is true (fails) when an item in `given` isn&#39;t in `valid`</span>
        <span class="n">comparison</span> <span class="o">=</span> <span class="o">~</span><span class="n">given</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
        <span class="n">passing_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;All values in&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">given</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                                <span class="s2">&quot;are valid.&quot;</span><span class="p">])</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">((</span><span class="n">comparison</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span> <span class="s2">&quot;values in&quot;</span><span class="p">,</span>
                             <span class="nb">str</span><span class="p">(</span><span class="n">given</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                             <span class="s2">&quot;were invalid&quot;</span><span class="p">,</span> <span class="n">report_list</span><span class="p">(</span>
                                 <span class="n">given</span><span class="p">[(</span><span class="n">comparison</span><span class="p">)])</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;These must be&quot;</span><span class="p">,</span> <span class="n">definition</span><span class="p">,</span> <span class="s2">&quot;to be valid.&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_condition</span><span class="p">(</span><span class="n">comparison</span><span class="p">,</span> <span class="n">Passing</span><span class="p">(</span><span class="n">passing_msg</span><span class="p">),</span>
                            <span class="n">Err</span><span class="p">(</span><span class="n">fail_msg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Validation.flag_elements"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.flag_elements">[docs]</a>    <span class="k">def</span> <span class="nf">flag_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_where</span><span class="p">,</span> <span class="n">flag_elements</span><span class="p">,</span> <span class="n">criteria</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check seeing if any values in flag_where are true,</span>
<span class="sd">        and then reports on the corresponding items in flag_elements.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag_where (Pandas Series): a boolean Pandas Series where True</span>
<span class="sd">                represents a failed check</span>
<span class="sd">            flag_elements (Pandas Series): a boolean Pandas Series listing</span>
<span class="sd">                elements that are affected by True values in `flag_where`</span>
<span class="sd">            criteria (String): a brief description of what elements are</span>
<span class="sd">                being flagged and reported on</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation(&quot;element test&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.flag_elements(pd.Series([False, False]),\</span>
<span class="sd">                                      pd.Series([&quot;A&quot;, &quot;B&quot;]), &quot;red flag(s)&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.flag_elements(pd.Series([False, True]),\</span>
<span class="sd">                                      pd.Series([&quot;A&quot;, &quot;B&quot;]), &quot;blue flag(s)&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating element test . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]          No red flag(s) in element test detected.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]          1 blue flag(s) in element test detected. These (&#39;B&#39;) will be treated as NA.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">passing_msg</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;No </span><span class="si">{criteria}</span><span class="s2"> in </span><span class="si">{self.name}</span><span class="s2"> detected.&quot;</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">flag_where</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span> <span class="n">criteria</span><span class="p">,</span> <span class="s2">&quot;in&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;detected.&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;These&quot;</span><span class="p">,</span> <span class="n">report_list</span><span class="p">(</span><span class="n">flag_elements</span><span class="p">[</span><span class="n">flag_where</span><span class="p">]),</span>
                             <span class="s2">&quot;will be treated as NA.&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_condition</span><span class="p">(</span><span class="n">flag_where</span><span class="p">,</span> <span class="n">Passing</span><span class="p">(</span><span class="n">passing_msg</span><span class="p">),</span>
                            <span class="n">Warn</span><span class="p">(</span><span class="n">fail_msg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Validation.flag_rows"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.flag_rows">[docs]</a>    <span class="k">def</span> <span class="nf">flag_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_where</span><span class="p">,</span> <span class="n">flag_criteria</span><span class="p">,</span> <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                  <span class="n">flag_tier</span><span class="o">=</span><span class="n">Warn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check seeing if any values in flag_where are true,</span>
<span class="sd">        where fail_check is of type flag_tier. Note that rows are reported</span>
<span class="sd">        counting from 0.</span>

<span class="sd">        Args:</span>
<span class="sd">            flag_where (Pandas Series): a boolean Pandas Series where True</span>
<span class="sd">                represents a failed check.</span>
<span class="sd">            flag_criteria (str): a noun clause describing the criteria for an</span>
<span class="sd">                item to be flagged in `flag_where`</span>
<span class="sd">            flag_action (str): string describing the action to be taken if</span>
<span class="sd">                an item is flagged. Defaults to &quot;&quot;.</span>
<span class="sd">            flag_tier (VCheck): should be either Suggest, Warn, or Err, is</span>
<span class="sd">                the seriousness of the failed check.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; v.flag_rows(pd.Series([False, False]),\</span>
<span class="sd">                                      flag_criteria=&quot;true values&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.flag_rows(pd.Series([False, True]),\</span>
<span class="sd">                                      flag_criteria=&quot;true values&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            CHECKS PASSED</span>
<span class="sd">            [X]      No true values detected.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            WARNINGS</span>
<span class="sd">            [?]      1 true values detected in row(s) #1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">passing_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="n">flag_criteria</span><span class="p">,</span> <span class="s2">&quot;detected.&quot;</span><span class="p">])</span>
        <span class="n">fail_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">flag_where</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span> <span class="n">flag_criteria</span><span class="p">,</span>
                             <span class="s2">&quot;detected in row(s)&quot;</span><span class="p">,</span> <span class="n">report_row</span><span class="p">(</span>
                                 <span class="n">flag_where</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
                             <span class="n">flag_action</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_condition</span><span class="p">(</span><span class="n">flag_where</span><span class="p">,</span> <span class="n">Passing</span><span class="p">(</span><span class="n">passing_msg</span><span class="p">),</span>
                            <span class="n">flag_tier</span><span class="p">(</span><span class="n">fail_msg</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_check_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">flag_criteria</span><span class="p">,</span> <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                  <span class="n">flag_tier</span><span class="o">=</span><span class="n">Warn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check flagging the rows in every column of `df`</span>
<span class="sd">        where applying the function condition changes the value of the element.</span>
<span class="sd">        Passes flag_criteria, flag_action and flag_tier on to flag_rows().</span>

<span class="sd">        Args:</span>
<span class="sd">            df (Pandas DataFrame): a Pandas DataFrame where each column should</span>
<span class="sd">                be checked</span>
<span class="sd">            condition (function): a function that corrects possible errors in</span>
<span class="sd">                each column, but does not change elements which are already</span>
<span class="sd">                fine.</span>
<span class="sd">            flag_criteria (str): a noun clause describing the criteria for an</span>
<span class="sd">                item to be changed by `condition`</span>
<span class="sd">            flag_action (str): string describing the action to be taken if</span>
<span class="sd">                an item is flagged. Defaults to &quot;&quot;.</span>
<span class="sd">            flag_tier (VCheck): should be either Suggest, Warn, or Err, is</span>
<span class="sd">                the seriousness of the failed check.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame: the Pandas DataFrame where condition() has been</span>
<span class="sd">                applied to every column.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; test_df = pd.DataFrame({&quot;A&quot;:[&quot;a&quot;,&quot;B&quot;,&quot;c&quot;], &quot;B&quot;:[&quot;D&quot;,&quot;e&quot;,&quot;F&quot;]})</span>
<span class="sd">            &gt;&gt;&gt; v._check_df(test_df, str.lower, flag_criteria=&quot;lowercase char&quot;)</span>
<span class="sd">               A  B</span>
<span class="sd">            0  a  d</span>
<span class="sd">            1  b  e</span>
<span class="sd">            2  c  f</span>

<span class="sd">            &gt;&gt;&gt; v._check_df(test_df, str.upper, flag_criteria=&quot;uppercase char&quot;)</span>
<span class="sd">               A  B</span>
<span class="sd">            0  A  D</span>
<span class="sd">            1  B  E</span>
<span class="sd">            2  C  F</span>

<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]      1 lowercase char column A detected in row(s) #1.</span>
<span class="sd">            [?]      2 lowercase char column B detected in row(s) #0, and #2.</span>
<span class="sd">            [?]      2 uppercase char column A detected in row(s) #0, and #2.</span>
<span class="sd">            [?]      1 uppercase char column B detected in row(s) #1.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">aseries</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">applied</span> <span class="o">=</span> <span class="n">aseries</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_rows</span><span class="p">(</span><span class="n">applied</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">aseries</span><span class="p">),</span>
                           <span class="n">flag_criteria</span> <span class="o">+</span> <span class="s2">&quot; column &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                           <span class="n">flag_action</span><span class="p">,</span>
                           <span class="n">flag_tier</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">applied</span>
        <span class="k">return</span> <span class="n">df</span>

<div class="viewcode-block" id="Validation.check_na"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.check_na">[docs]</a>    <span class="k">def</span> <span class="nf">check_na</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check flagging the rows in every column of `df`</span>
<span class="sd">        that are `None`</span>

<span class="sd">        Args:</span>
<span class="sd">            df (Pandas DataFrame): a Pandas DataFrame with columns that should</span>
<span class="sd">                have no NA values</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; test_df = pd.DataFrame({&quot;A&quot;:[&quot;a&quot;,&quot;B&quot;,&quot;c&quot;], &quot;B&quot;:[&quot;D&quot;,&quot;e&quot;,None]})</span>
<span class="sd">            &gt;&gt;&gt; v.check_na(test_df)</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]          No NA&#39;s in column A detected.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]          1 NA&#39;s in column B detected in row(s) #2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                       <span class="n">condition</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span>
                       <span class="n">flag_criteria</span><span class="o">=</span><span class="s2">&quot;NA&#39;s in&quot;</span><span class="p">,</span>
                       <span class="n">flag_tier</span><span class="o">=</span><span class="n">Warn</span>
                       <span class="p">)</span></div>

<div class="viewcode-block" id="Validation.fix_whitespace"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.fix_whitespace">[docs]</a>    <span class="k">def</span> <span class="nf">fix_whitespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check flagging the rows in every column of `df`</span>
<span class="sd">        that contain whitespace</span>

<span class="sd">        Args:</span>
<span class="sd">            df (Pandas DataFrame): a Pandas DataFrame with columns that should</span>
<span class="sd">                have no whitespace</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame: `df` where whitespace is replaced with an</span>
<span class="sd">                underscore</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; test_df = pd.DataFrame({&quot;A&quot;:[&quot;a&quot;,&quot; B &quot;,&quot;Test Data&quot;],\</span>
<span class="sd">                                        &quot;B&quot;:[&quot;D&quot;,&quot; e&quot;,&quot;F &quot;]})</span>
<span class="sd">            &gt;&gt;&gt; v.fix_whitespace(test_df)</span>
<span class="sd">                       A  B</span>
<span class="sd">            0          a  D</span>
<span class="sd">            1          B  e</span>
<span class="sd">            2  Test_Data  F</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]          No whitespace in column B detected.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]          1 leading/trailing spaces column A detected in row(s) #1.\</span>
<span class="sd">            Leading/trailing spaces will be removed.</span>
<span class="sd">            [?]          2 leading/trailing spaces column B detected in row(s)\</span>
<span class="sd">            #1, and #2. Leading/trailing spaces will be removed.</span>
<span class="sd">            [?]          1 whitespace in column A detected in row(s) #2.\</span>
<span class="sd">            Whitespace will be converted to &#39;_&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stripped_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_df</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
                                     <span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span>
                                     <span class="n">flag_criteria</span><span class="o">=</span><span class="s2">&quot;leading/trailing &quot;</span>
                                     <span class="s2">&quot;spaces&quot;</span><span class="p">,</span>
                                     <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;Leading/trailing spaces &quot;</span>
                                     <span class="s2">&quot;will be removed.&quot;</span><span class="p">)</span>
        <span class="c1"># pass stripped_df to check_df with a regex expression to replace</span>
        <span class="c1"># remaining whitespace with underscores, except for the &quot; to &quot;</span>
        <span class="c1"># construction</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_df</span><span class="p">(</span><span class="n">stripped_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
                              <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?&lt;!to)\s(?!to)&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
                              <span class="n">flag_criteria</span><span class="o">=</span><span class="s2">&quot;whitespace in&quot;</span><span class="p">,</span>
                              <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;Whitespace will be converted to &#39;_&#39;&quot;</span>
                              <span class="p">)</span></div>

<div class="viewcode-block" id="Validation.fix_alnum"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.fix_alnum">[docs]</a>    <span class="k">def</span> <span class="nf">fix_alnum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check flagging the rows in every column of `df`</span>
<span class="sd">        that contain non-alphanumeric characters. Regex removes all characters</span>
<span class="sd">        that are not alpha-numeric, but leaves periods that are part of a</span>
<span class="sd">        number.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (Pandas DataFrame): a Pandas DataFrame with columns that should</span>
<span class="sd">                have only alphanumeric characters</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame: `df` where alphanumeric characters are removed</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; test_df = pd.DataFrame({&quot;A&quot;:[&quot;a&quot;,&quot;3.0&quot;,&quot;c&quot;],\</span>
<span class="sd">                                        &quot;B&quot;:[&quot;??.test&quot;,&quot;test&lt;&gt;!&quot;,&quot;;test_data&quot;]})</span>
<span class="sd">            &gt;&gt;&gt; v.fix_alnum(test_df)</span>
<span class="sd">               A          B</span>
<span class="sd">            0  a       test</span>
<span class="sd">            1  3.0     test</span>
<span class="sd">            2  c  test_data</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]      No non-alphanumeric value(s) in column A detected.</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]      3 non-alphanumeric value(s) in column B detected in row(s)</span>
<span class="sd">            #0, #1, and #2. This text should be alphanumeric. Non-alphanumeric</span>
<span class="sd">            characters will be removed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                              <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^a-zA-Z0-9_ -\.]|\.(?!\d)|\!&quot;</span><span class="p">,</span>
                                               <span class="sa">r</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
                              <span class="n">flag_criteria</span><span class="o">=</span><span class="s2">&quot;non-alphanumeric value(s) in&quot;</span><span class="p">,</span>
                              <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;This text should be alphanumeric. &quot;</span>
                              <span class="s2">&quot;Non-alphanumeric characters will be removed.&quot;</span>
                              <span class="p">)</span></div>

<div class="viewcode-block" id="Validation.fix_lowcase"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.fix_lowcase">[docs]</a>    <span class="k">def</span> <span class="nf">fix_lowcase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check flagging the rows in every column of `df`</span>
<span class="sd">        that contain lowercase characters.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (Pandas DataFrame): a Pandas DataFrame with columns that should</span>
<span class="sd">                have only uppercase characters</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame: `df` where all characters are uppercase</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; test_df = pd.DataFrame({&quot;A&quot;:[&quot;a&quot;,&quot;B&quot;,&quot;c&quot;], &quot;B&quot;:[&quot;D&quot;,&quot;e&quot;,&quot;F&quot;]})</span>
<span class="sd">            &gt;&gt;&gt; v.fix_lowcase(test_df)</span>
<span class="sd">               A  B</span>
<span class="sd">            0  A  D</span>
<span class="sd">            1  B  E</span>
<span class="sd">            2  C  F</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]      2 lower case value(s) in  column A detected in row(s) #0,</span>
<span class="sd">            and #2. Convention to have this text be uppercase. Lower case text</span>
<span class="sd">            will be made uppercase.</span>
<span class="sd">            [?]      1 lower case value(s) in  column B detected in row(s) #1.</span>
<span class="sd">            Convention to have this text be uppercase. Lower case text will be</span>
<span class="sd">            made uppercase.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_df</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
                              <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                              <span class="n">flag_criteria</span><span class="o">=</span><span class="s2">&quot;lower case value(s) in &quot;</span><span class="p">,</span>
                              <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;Convention to have this text be &quot;</span>
                              <span class="s2">&quot;uppercase. Lower case text will be made &quot;</span>
                              <span class="s2">&quot;uppercase.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Validation.fix_upcase"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.fix_upcase">[docs]</a>    <span class="k">def</span> <span class="nf">fix_upcase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a validation check flagging the rows in every column of `df`</span>
<span class="sd">        that contain uppercase characters</span>

<span class="sd">        Args:</span>
<span class="sd">            df (Pandas DataFrame): a Pandas DataFrame with columns that should</span>
<span class="sd">                have only lowercase characters</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame: `df` where all characters are lowercase</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; test_df = pd.DataFrame({&quot;A&quot;:[&quot;a&quot;,&quot;B&quot;,&quot;c&quot;], &quot;B&quot;:[&quot;D&quot;,&quot;e&quot;,&quot;F&quot;]})</span>
<span class="sd">            &gt;&gt;&gt; v.fix_upcase(test_df)</span>
<span class="sd">               A  B</span>
<span class="sd">            0  a  d</span>
<span class="sd">            1  b  e</span>
<span class="sd">            2  c  f</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating  . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]      1 upper case value(s) in column A detected in row(s) #1.</span>
<span class="sd">            Convention is to have this text be lowercase. Upper case text will</span>
<span class="sd">            be made lowercase.</span>
<span class="sd">            [?]      2 upper case value(s) in column B detected in row(s) #0,</span>
<span class="sd">            and #2. Convention is to have this text be lowercase. Upper case</span>
<span class="sd">            text will be made lowercase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_df</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
                              <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                              <span class="n">flag_criteria</span><span class="o">=</span><span class="s2">&quot;upper case value(s) in&quot;</span><span class="p">,</span>
                              <span class="n">flag_action</span><span class="o">=</span><span class="s2">&quot;Convention is to have this text be &quot;</span>
                              <span class="s2">&quot;lowercase. Upper case text will be made&quot;</span>
                              <span class="s2">&quot; lowercase.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Validation.is_valid"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.is_valid">[docs]</a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks to see if instance is valid.</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if is valid (has no errors in vchecks) and False if</span>
<span class="sd">                instance has errors or where vchecks is empty.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; Validation().is_valid()</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; v = Validation()</span>
<span class="sd">            &gt;&gt;&gt; v.must_contain(pd.Series([&quot;A&quot;, &quot;B&quot;]), pd.Series([&quot;B&quot;]))</span>
<span class="sd">            &gt;&gt;&gt; v.is_valid()</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; v.must_contain(pd.Series([&quot;A&quot;, &quot;B&quot;]), pd.Series([&quot;C&quot;]))</span>
<span class="sd">            &gt;&gt;&gt; v.is_valid()</span>
<span class="sd">            False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="p">[</span><span class="s2">&quot;Tier&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Error&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Validation.report"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.Validation.report">[docs]</a>    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints the checks in the vchecks attribute</span>

<span class="sd">        Args:</span>
<span class="sd">            verbose (int): Parameter controlling how much to print by filtering</span>
<span class="sd">                for the level in each vchecks row to be less than or equal to</span>
<span class="sd">                verbose. Defaults to 2 (print only converted `Warn` and `Err`</span>
<span class="sd">                checks)</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; v = Validation(&quot;Testing Tests&quot;)</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, False]),\</span>
<span class="sd">                                 Passing(&quot;Passed test&quot;), Err(&quot;Failed test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, False]),\</span>
<span class="sd">                                 Passing(&quot;Passed test 2&quot;), Err(&quot;Failed test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, True]),\</span>
<span class="sd">                                 Passing(&quot;Passed test&quot;), Err(&quot;Error test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, True]),\</span>
<span class="sd">                                 Passing(&quot;Passed test&quot;), Warn(&quot;Warn test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v._add_condition(pd.Series([False, False, True]),\</span>
<span class="sd">                                 Passing(&quot;&quot;), Suggest(&quot;Suggest test&quot;))</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=1)</span>
<span class="sd">            Validating Testing Tests . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             ERRORS</span>
<span class="sd">            [!]      Error test</span>
<span class="sd">            &gt;&gt;&gt; v.report(verbose=4)</span>
<span class="sd">            Validating Testing Tests . . .</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             CHECKS PASSED</span>
<span class="sd">            [X]      Passed test</span>
<span class="sd">            [X]      Passed test 2</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             ERRORS</span>
<span class="sd">            [!]      Error test</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             SUGGESTIONS</span>
<span class="sd">            [i]      Suggest test</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">             WARNINGS</span>
<span class="sd">            [?]      Warn test</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No validation checks made.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">within_verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vchecks</span><span class="p">[</span><span class="s2">&quot;Level&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">verbose</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">within_verbose</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Validating </span><span class="si">{self.name}</span><span class="s2"> . . .&quot;</span><span class="p">)</span>
        <span class="n">final_reports</span> <span class="o">=</span> <span class="n">within_verbose</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">final_reports</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">single_report</span> <span class="ow">in</span> <span class="n">final_reports</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">single_report</span><span class="p">[</span><span class="s2">&quot;Bullet&quot;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
                      <span class="n">single_report</span><span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="report_row"><a class="viewcode-back" href="../../source/pycrossva.html#pycrossva.validation.report_row">[docs]</a><span class="k">def</span> <span class="nf">report_row</span><span class="p">(</span><span class="n">flag_where</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A helper method to return an english explanation of what rows have been</span>
<span class="sd">    flagged with a failed validation check.</span>

<span class="sd">    Args:</span>
<span class="sd">        flag_where (Pandas Series): boolean Pandas Series representing failed</span>
<span class="sd">            validation checks.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: a string reporting the index of the flagged rows</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; report_row(pd.Series([True, True, False, True, False]))</span>
<span class="sd">        &#39;#0, #1, and #3&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flagged</span> <span class="o">=</span> <span class="n">flag_where</span><span class="p">[</span><span class="n">flag_where</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">flagged</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_numeric</span><span class="p">():</span>
        <span class="n">unformatted_report</span> <span class="o">=</span> <span class="n">report_list</span><span class="p">(</span><span class="n">flagged</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">paren</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&#39;(\d+)&#39;&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;#\1&quot;</span><span class="p">,</span> <span class="n">unformatted_report</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">report_list</span><span class="p">(</span><span class="n">flagged</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">paren</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">NORMALIZE_WHITESPACE</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MITRE

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'1.0a',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>